!function(t,e,n,a,i,r){"use strict";function o(){}o.prototype=o,o.Util=function(){function e(){}return e.prototype={getParameterByName:function(e,n){n||(n=t.location.href),e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=a.exec(n);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},getParameterPartsByName:function(t){var e=this.getParameterByName(t);if(e)return e.split(",")},addClass:function(t,e){t.classList?t.classList.add(e):t.className+=" "+e},removeClass:function(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}},e}(),o.I18N={LANGUAGES:["en","rs"],SOURCE:{DISTANCE:[{en:"Distance"},{rs:"Udaljenost"}],ELEVATION:[{en:"Elevation"},{rs:"Visina"}]}};var s="f",c="c",l="t",u="l",d="marker",m="track",p="kml";!function(t){t.maps.Polyline.prototype.getBounds=function(){var e=new t.maps.LatLngBounds;return this.getPath().forEach(function(n){e.extend(new t.maps.LatLng(n.lat(),n.lng()))}),e}}(i);var h="en",f="../examples/angularjs-with-material.html#!",v=[{url:"../data/locations-"+h+".json",name:"Locations",type:d,visible:!0},{url:"../data/tourism.json",name:"tourism",type:d,visible:!0},{url:"../data/marathon.json",name:"Marathons",type:m,visible:!1},{url:"../data/protection.json",name:"Protection",type:p,visible:!1},{url:"../data/time.json",name:"Time",type:d,visible:!1}];o.Marker=function(){function t(t){this.options=t,this.data=t.data,this.setValues({position:new i.maps.LatLng(parseFloat(t.position.lat()),parseFloat(t.position.lng())),map:E})}function e(t){var e="";return t.image&&(e+='<img src="'+t.image+'">'),e+="<h2>"+t.title+"</h2>",t.description&&(e+="<p>"+t.description+"</p>"),e="<a"+(t.link&&' href="'+t.link+'" target="_blank"')+">"+e+"</a>"}return t.prototype=new i.maps.OverlayView,t.prototype.draw=function(){var t=this,e=this.div;if(!e){e=this.div=n("<div"+(this.options.visible?"":' class="hidden"')+'><div class="marker-shadow"></div><div class="marker-wrap" title="'+this.options.title+'"><div class="marker marker-'+this.options.icon+'"></div></div></div>')[0],this.markerWrap=this.div.getElementsByClassName("marker-wrap"),this.marker=this.div.getElementsByClassName("marker"),this.markerShadow=this.div.getElementsByClassName("marker-shadow"),e.style.position="absolute",e.style.cursor="pointer";var a=this.getPanes();a.overlayImage.appendChild(e),setTimeout(function(){t.animateWobble()},800*Math.random()+200),i.maps.event.addDomListener(e,"click",function(){t.animateWobble(),t.showInfoWindow()})}t.setPoint(t.position)},t.prototype.setPoint=function(t){var e=this.getProjection().fromLatLngToDivPixel(t);this.div.style.left=e.x+"px",this.div.style.top=e.y+"px",this.div.style.zIndex=Math.round(100*e.y)},t.prototype.setVisible=function(t){var e=this;e.div&&(t?setTimeout(function(){g.removeClass(e.div,"hidden"),e.animateWobble()},400*Math.random()):setTimeout(function(){g.addClass(e.div,"hidden")},200*Math.random()))},t.prototype.setOpaque=function(t){this.div&&(t?g.addClass(this.div,"opaque"):g.removeClass(this.div,"opaque"))},t.prototype.getPosition=function(){return this.position},t.prototype.remove=function(){this.div.remove()},t.prototype.onRemove=function(){this.remove()},t.prototype.showInfoWindow=function(){M.showInfoWindow(e(this.options.data),this.getPosition())},t.prototype.animateDrop=function(){dynamics.stop(this.markerWrap),dynamics.css(this.markerWrap,{transform:"scaleY(2) translateY(-"+n("#map").outerHeight()+"px)",opacity:"1"}),dynamics.animate(this.markerWrap,{translateY:0,scaleY:1},{type:dynamics.gravity,duration:1800}),dynamics.stop(this.marker),dynamics.css(this.marker,{transform:"none"}),dynamics.animate(this.marker,{scaleY:.8},{type:dynamics.bounce,duration:1800,bounciness:600}),dynamics.stop(this.markerShadow),dynamics.css(this.markerShadow,{transform:"scale(0,0)"}),dynamics.animate(this.markerShadow,{scale:1},{type:dynamics.gravity,duration:1800})},t.prototype.animateBounce=function(){dynamics.stop(this.markerWrap),dynamics.css(this.markerWrap,{transform:"none"}),dynamics.animate(this.markerWrap,{translateY:-30},{type:dynamics.forceWithGravity,bounciness:0,duration:500,delay:150}),dynamics.stop(this.marker),dynamics.css(this.marker,{transform:"none"}),dynamics.animate(this.marker,{scaleY:.8},{type:dynamics.bounce,duration:800,bounciness:0}),dynamics.animate(this.marker,{scaleY:.8},{type:dynamics.bounce,duration:800,bounciness:600,delay:650}),dynamics.stop(this.markerShadow),dynamics.css(this.markerShadow,{transform:"none"}),dynamics.animate(this.markerShadow,{scale:.6},{type:dynamics.forceWithGravity,bounciness:0,duration:500,delay:150})},t.prototype.animateWobble=function(){dynamics.stop(this.markerWrap),dynamics.css(this.markerWrap,{transform:"none"}),dynamics.animate(this.markerWrap,{rotateZ:90*Math.random()-45},{type:dynamics.bounce,duration:1800}),dynamics.stop(this.marker),dynamics.css(this.marker,{transform:"none"}),dynamics.animate(this.marker,{scaleX:.8},{type:dynamics.bounce,duration:800,bounciness:1800})},t}(),o.Track=function(){function t(t){return t=a.extend({map:E,geodesic:!0,strokeColor:"rgb(51, 102, 204)",strokeOpacity:1,strokeWeight:4},t),function(){return new i.maps.Polyline(t)}()}return t}(),o.Kml=function(){function t(t,e){return e=a.extend({map:E,preserveViewport:!0,suppressInfoWindows:!0,data:{type:"kml"}},e),function(){return new i.maps.KmlLayer(t,e)}()}return t}(),o.I18n=function(){function t(t){this.lang=t,Object.keys(o.I18N.SOURCE).forEach(function(t){e(t,o.I18N.SOURCE[t])})}function e(t,e){e.forEach(function(e){o.I18N.LANGUAGES.forEach(function(a){e[a]&&(n[a]||(n[a]={}),n[a][t]=e[a])})})}var n={};return t.prototype={translate:function(t){return n[this.lang]&&n[this.lang][t]||"__TRANSLATION_MISSING__"}},t}(),o.Chart=function(){function a(t){var e=this;e.visible=!1,e.container=t}function r(t,e,n){var a=[];t.forEach(function(t){a.push(t)}),e.getElevationAlongPath({path:a,samples:a.length},function(t){var e=0,a=[];t.forEach(function(n,i){var r;r=i?s(t[i].location,t[i-1].location):0,e+=parseFloat(r),a.push([e,n.elevation])}),n(a)})}function s(t,e){var n=6378137,a=c(e.lat()-t.lat()),i=c(e.lng()-t.lng()),r=Math.sin(a/2)*Math.sin(a/2)+Math.cos(c(t.lat()))*Math.cos(c(e.lat()))*Math.sin(i/2)*Math.sin(i/2),o=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)),s=n*o;return(s/1e3).toFixed(2)}function c(t){return t*Math.PI/180}return a.prototype={setVisible:function(t){var e=this;e.visible=t;var a="on";e.visible?n(e.container).addClass(a):(n(e.container).removeClass(a),M.placeMarker());var r=E.getCenter();i.maps.event.trigger(E,"resize"),E.setCenter(r)},show:function(a,s){var c=this;c.setVisible(!0),s&&n(c.container).find("button").remove();var l=new i.maps.ElevationService;i.charts.load("current",{packages:["corechart"],language:o.lang}),i.charts.setOnLoadCallback(function(){r(a,l,function(r){var o=new i.visualization.DataTable;o.addColumn("number",y.translate("DISTANCE")),o.addColumn("number",y.translate("ELEVATION")),o.addRows(r);var s={lineWidth:2,areaOpacity:.2,series:[{color:"black",visibleInLegend:!1},{},{}],focusTarget:"category",hAxis:{baselineColor:"transparent",title:y.translate("DISTANCE")+" (km)",gridlines:{color:"transparent"}},vAxis:{baselineColor:"transparent",title:y.translate("ELEVATION")+" (m)",minValue:0,gridlines:{color:"transparent"}},legend:{position:"none"}},c=new i.visualization.AreaChart(e.getElementById("chart"));c.draw(o,s),i.visualization.events.addListener(c,"onmouseover",function(t){M.placeMarker(a.getAt(t.row))}),n(t).on("resize",function(){c.draw(o,s)})})})}},t.closeChart=function(){N.setVisible(!1)},a}(),o.Map=function(){function e(e){this.infoWindow=new i.maps.InfoWindow({maxWidth:285,content:"holding..."}),(o.isCrossDomain||t.frameElement&&t.frameElement.hasAttribute("allowFullScreen"))&&n("#map_container > button").show()}function a(t){if(t)return t.hasOwnProperty("position")?d:t.hasOwnProperty("strokeColor")?m:t.hasOwnProperty("suppressInfoWindows")?p:void 0}return e.prototype={add:function(t,e,n){var a=this;return new r(function(i){switch(e){case d:return a.addMarker(t,n).then(function(t){i(t)});case m:return a.addTrack(t,n).then(function(t){i(t)});case p:return a.addKml(t,n).then(function(t){i(t)})}})},addMarker:function(t,e){return new r(function(n){var a=new o.Marker({position:new i.maps.LatLng(t.lat,t.lng),title:t.data.title,icon:t.tag,data:t.data,visible:e});i.maps.event.addListener(a,"click",function(){a.animateWobble()}),n(a)})},addTrack:function(t,e){var a;return a="string"==typeof t?t:"../"+t.url,new r(function(t){return n.get(a).then(function(a){var r=[];n(a).find("trkpt").each(function(t,e){var a=Number(n(this).attr("lat")),o=Number(n(this).attr("lon")),s=new i.maps.LatLng(a,o);r.push(s)});var s=new o.Track({path:r});s.setVisible(e),t(s)})})},addKml:function(t,e){return new r(function(n){var a=new o.Kml(t.url);e||a.setMap(null),n(a)})},setVisible:function(t,e){switch(a(t)){case d:t.setVisible(e);break;case m:t.setVisible(e);break;case p:t.setMap(e?E:null)}},focus:function(t,e){var n=this;switch(a(t)){case d:E.setZoom(14),E.panTo(t.position);var r=setInterval(function(){t.animateBounce()},2e3);i.maps.event.addDomListener(t.div,"click",function(){clearInterval(r)});break;case m:n.placeMarker(null),E.fitBounds(t.getBounds()),N.show(t.getPath(),e)}},placeMarker:function(t){var e=this;t?e.marker?e.marker.setPoint(t):e.marker=new o.Marker({position:t,visible:!0}):e.marker&&(e.marker.remove(),e.marker=null)},showInfoWindow:function(t,e){var n=this;n.infoWindow.setContent(t),n.infoWindow.setPosition(e),n.infoWindow.open(E)},fullscreen:function(){var e={c:E.getCenter().lat()+","+E.getCenter().lng()+","+E.getZoom(),l:g.getParameterByName(u),f:g.getParameterByName(s),t:g.getParameterByName(l),lang:o.lang},n=f+"?"+Object.keys(e).map(function(t){return e[t]&&encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&");t.open(n,"_blank")}},t.fullscreen=function(){M.fullscreen()},e}(),o.Storage=function(){function t(t){t||(t=[]),this.data=t}function e(t){if(t=i(t),n(t)){var e=t.split(":");return e.splice(-1),e.join(":")}}function n(t){return t=i(t),t.indexOf(":")!==-1}function i(t){if(t)return"string"!=typeof t&&(t=t.join(":")),t.toLowerCase()}function o(t,e){e=i(e);var n=[];return t.forEach(function(t){if(t.id){var a;a=e?i([e,t.id]):t.id;var r={id:t.id,getVisible:function(){return w.getState(a)},setVisible:function(t){return w.setState(a,t)},focus:function(){return w.focus(a)}};if(t.type&&(r.type=t.type),t.children&&t.children.length){var s=o(t.children,a);s&&s.length&&(r.children=s)}t.categories&&t.categories.length&&(r.categories=t.categories,r.highlight=function(t){w.highlight(r.id,t)}),n.push(r)}}),n}return t.prototype={add:function(t,n,a,o){var s=this;n=i(n);var c;if(n){var l=s.get(n);l&&(l.children||(l.children=[]),c=l.children)}else c=s.data;return a?(l.type=a,t.categories&&t.categories.forEach(function(t){var a=s.get(e(n));a&&(a.categories||(a.categories=[]),a.categories.indexOf(t)===-1&&a.categories.push(t))}),M.add(t,a,o).then(function(e){t.categories&&(e.categories=t.categories),c.push(e)})):new r(function(e){c.push(t),e(t)})},root:function(){return this.data},get:function(t,e){if(t=i(t),e||(e=this.data),t){if(t.indexOf(":")!==-1){var n=t.split(":"),e=a.find(e,{id:n[0]}).children;return n=n.splice(1),this.get(n.join(":"),e)}return a.find(e,function(e){if(e&&e.id===t||e.hasOwnProperty("data")&&e.data.id==t)return e})}},query:function(t,e){t=i(t),e||(e=this.data);var n=this.get(t,e);return n.children},setState:function(t,e){t=i(t);var n=this.get(t);n&&(n.on=e,this.setVisible(t,e))},getState:function(t){t=i(t);var e=this.get(t);if(e)return e.on},setVisible:function(t,e){t=i(t);var n=this,a=this.get(t);a&&(a.visible=e,a.children&&a.children.forEach(function(i){if(i.id)n.setVisible([t,i.id],e);else{var r=!!e&&a.on;M.setVisible(i,r)}}))},getVisible:function(t){t=i(t);var a=this.get(t),r=!0;if(a&&(r=a.visible,n(t))){var o=e(t),s=this.getVisible(o);if(!s)return!1;if(n(o))return this.getVisible(e(o))}return r},focus:function(t,a){var r=this;t=i(t);var o=r.get(t);if(n(t)){var s=r.get(e(t));r.setState(s.id,!0),s.children.forEach(function(t){t.hasOwnProperty("id")&&r.setState([s.id,t.id],t.id===o.id)})}M.focus(o&&o.hasOwnProperty("children")?o.children[0]:o,a)},highlight:function(t,e){var n=this;t=i(t);var a=n.get(t);a.children&&a.children.forEach(function(t){t.children&&t.children.forEach(function(t){var n=e&&t.categories.indexOf(e)===-1;t.setOpaque(n),n||t.animateWobble()})})},getSelectors:function(){return o(w.root())}},t}(),o.Loader=function(){function t(){}function e(t,e,a,i){return w.add({id:e.toLowerCase(),visible:i,on:i}).then(function(){return n.get(t).success(function(t){var n=[];return t.forEach(function(t){var o,s=w.get([e,t.tag]);o=s?new r(function(t){t()}):w.add({id:t.tag.toLowerCase(),visible:i,on:i,type:a},e),o.then(function(){w.add(t,[e.toLowerCase(),t.tag],a,i)}),n.push(o)}),r.all(n)})})}return t.prototype={load:function(t){var n=[];return t.forEach(function(t){n.push(e.apply(this,t))}),r.all(n)},append:function(t,e){return M.add(t,e,!0)}},t}(),o.Api=function(){function t(){}return t.prototype={ready:function(t){t()},getData:function(){return w.getSelectors()},clustering:function(t){void 0===t||(clusterer.enabled=t,t?(clusterer.setMaxZoom(null),clusterer.setGridSize(50)):(clusterer.setMaxZoom(1),clusterer.setGridSize(1)),clusterer.resetViewport(),clusterer.redraw())},type:function(t){return void 0===t?E.getMapTypeId():E.setMapTypeId(t)}},t}(),t.fruskac=new o.Api;var g=new o.Util;o.isCrossDomain=t.self!==t.top&&e.referrer&&!new RegExp("//"+e.domain).test(e.referrer),o.lang=g.getParameterByName("lang")||t.self!==t.top&&t.top.document.documentElement.lang||h;var y=new o.I18n(o.lang),w=new o.Storage,b={center:new i.maps.LatLng(45.167031,19.69677),zoom:11,mapTypeId:i.maps.MapTypeId.TERRAIN,mapTypeControl:!1,zoomControlOptions:{position:i.maps.ControlPosition.LEFT_BOTTOM},streetViewControlOptions:{position:i.maps.ControlPosition.LEFT_BOTTOM}},k=g.getParameterByName(c);if(k){var C=g.getParameterPartsByName(c);C&&C.length&&(C[0]&&C[1]&&(b.center=new i.maps.LatLng(C[0],C[1])),C[2]&&(b.zoom=parseFloat(C[2])))}var E=new i.maps.Map(e.getElementById("map"),b),L={north:45.166508,south:45.136001,east:19.767672,west:19.681498},P={opacity:.8,clickable:!1},I=new i.maps.GroundOverlay("img/overlay.png",L,P);I.setMap(E);var M=new o.Map(E),N=new o.Chart(e.getElementById("chart_container")),O=v,S=[],T=g.getParameterPartsByName(u);O.forEach(function(t){T&&(t.visible=T.indexOf(t.name)!==-1),S.push(Object.values(t))});var W=g.getParameterByName(l),V=new o.Loader,B=g.getParameterByName(s);V.load(S).then(function(){W&&V.append(W,m).then(function(t){i.maps.event.addListenerOnce(E,"idle",function(){M.focus(t)})}),B&&i.maps.event.addListenerOnce(E,"idle",function(){w.focus(B,!0)})})}(window,document,jQuery,_,google,Promise);
//# sourceMappingURL=map.min.js.map
